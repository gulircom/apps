!function(t){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var e=[],a=!1,r={width:"resolve",triggerChange:!0,allowClear:!0};redux.field_objects.typography.init=function(o,p){o||(o=t(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),t(o).each(function(){var o,p=t(this),s=p;if(p.hasClass("redux-field-container")||(s=p.parents(".redux-field-container:first")),!s.is(":hidden"))s.hasClass("redux-field-init")&&(s.removeClass("redux-field-init"),p.each(function(){t(this).find(".redux-typography-container").each(function(){var e=t(this).find(".redux-typography-family");void 0===e.data("value")?e=t(this):""!==e.data("value")&&t(e).val(e.data("value"));var a=t(this).find(".select2_params");if(a.size()>0){var p=a.val();p=JSON.parse(p),r=t.extend({},r,p)}o=Boolean(t(this).find(".redux-font-clear").val()),redux.field_objects.typography.select(e,!0),window.onbeforeunload=null}),t(this).find(".redux-typography").on("change",function(){redux.field_objects.typography.select(t(this))}),t(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").keyup(function(){redux.field_objects.typography.select(t(this).parents(".redux-container-typography:first"))}),t(this).find(".redux-typography-color").wpColorPicker({change:function(e,a){t(this).val(a.color.toString()),redux.field_objects.typography.select(t(this))}}),t(this).find(".redux-typography-size").numeric({allowMinus:!1}),t(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0});var s=[{id:"none",text:"none"}];t(this).find(".redux-typography-family").select2({matcher:function(t,e){return 0===e.toUpperCase().indexOf(t.toUpperCase())},query:function(t){return window.Select2.query.local(s)(t)},initSelection:function(t,e){e({id:t.val(),text:t.val()})},allowClear:o}).on("select2-opening",function(e){var a=t(this).parents(".redux-container-typography:first").attr("data-id"),r=t("#"+a+" .redux-typography-font-family").data("user-fonts");r=r?1:0;var o=t("#"+a+" .redux-typography-google").val();o=o?1:0;var p=[];if(void 0!==redux.customfonts&&p.push(redux.customfonts),void 0!==redux.stdfonts&&0===r&&p.push(redux.stdfonts),1==r){var i=[];for(var y in redux.typography[a]){var l=redux.typography[a].std_font;for(var n in l)l.hasOwnProperty(n)&&i.push({id:n,text:n,"data-google":"false"})}p.push({text:"Standard Fonts",children:i})}(1==o||!0===o&&void 0!==redux.googlefonts)&&p.push(redux.googlefonts),s=p;var d=t("#"+a+" #"+a+"-family").attr("placeholder");d||(d=null),t("#"+a+" .redux-typography-family").select2("val",d)}).on("select2-selecting",function(r,o){var p=r.object.text,s=t(this).parents(".redux-container-typography:first").attr("data-id");t("#"+s+" #"+s+"-family").data("value",p),t("#"+s+" #"+s+"-family").attr("placeholder",p),e=r,a=!0,redux.field_objects.typography.select(t(this).parents(".redux-container-typography:first"))}).on("select2-clearing",function(e,a){var r=t(this).parents(".redux-container-typography:first").attr("data-id");t("#"+r+" #"+r+"-family").attr("data-value",""),t("#"+r+" #"+r+"-family").attr("placeholder","Font Family"),t("#"+r+" #"+r+"-google-font").val("false"),redux.field_objects.typography.select(t(this).parents(".redux-container-typography:first"))}),p.find(".redux-typography-family").hasClass("redux-typography-family")||p.find(".redux-typography-style").select2(r),p.find(".redux-typography-family-backup, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").select2(r)}))})},redux.field_objects.typography.size=function(t){var e,a=0;for(e in t)t.hasOwnProperty(e)&&a++;return a},redux.field_objects.typography.makeBool=function(t){return"false"!=t&&"0"!=t&&!1!==t&&0!==t&&("true"==t||"1"==t||!0===t||1==t||void 0)},redux.field_objects.typography.contrastColour=function(t){var e="#444444";if(""!==t){var a=parseInt((t=t.replace("#","")).substr(0,2),16),r=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16);e=(299*a+587*r+114*o)/1e3>=128?"#444444":"#ffffff"}return e},redux.field_objects.typography.select=function(o,p){void 0===(s=t(o).parents(".redux-container-typography:first").attr("data-id"))&&(s=t(o).attr("data-id")),t(o).parents(".redux-container-typography:first");var s,i,y=t("#"+s+" #"+s+"-family").val();y||(y=null);var l=t("#"+s+" select.redux-typography-family-backup").val(),n=t("#"+s+" .redux-typography-size").val(),d=t("#"+s+" .redux-typography-height").val(),h=t("#"+s+" .redux-typography-word").val(),g=t("#"+s+" .redux-typography-letter").val(),c=t("#"+s+" select.redux-typography-align").val(),u=t("#"+s+" select.redux-typography-transform").val(),f=t("#"+s+" select.redux-typography-font-variant").val(),v=t("#"+s+" select.redux-typography-decoration").val(),x=t("#"+s+" select.redux-typography-style").val(),$=t("#"+s+" select.redux-typography-subsets").val(),b=t("#"+s+" .redux-typography-color").val(),m=t("#"+s).data("units");!0===a?(i=redux.field_objects.typography.makeBool(e.object["data-google"]),t("#"+s+" .redux-typography-google-font").val(i)):i=redux.field_objects.typography.makeBool(t("#"+s+" .redux-typography-google-font").val()),t("#"+s).hasClass("typography-initialized")||(x=t("#"+s+" select.redux-typography-style").data("value"),$=t("#"+s+" select.redux-typography-subsets").data("value"),""!==x&&(x=String(x)),$=String($)),void 0===redux.fonts.google&&(i=!1);var w="";if(!0===i&&y in redux.fonts.google)w=redux.fonts.google[y];else{w={300:"Book 300",400:"Normal 400",600:"Semi-Bold 600",700:"Bold 700",900:"Ultra-Bold 700","300italic":"Book 300 Italic","400italic":"Normal 400 Italic","600italic":"Semi-Bold 600 Italic","700italic":"Bold 700 Italic","900italic":"Ultra-Bold 900 Italic"};let _=redux.customfonts?.children?.find(({id:t})=>t===y);_&&(w=Array.isArray(_.variants)?Object.assign({},..._.variants):_.variants)}if(t(o).hasClass("redux-typography-subsets")&&t("#"+s+" input.typography-subsets").val($),t(o).hasClass("redux-typography-family")){var j='<option value=""></option>';if(!0===i){var C="";t.each(w.variants,function(t,e){e.id===x||1===redux.field_objects.typography.size(w.variants)?(C=' selected="selected"',x=e.id):C="",j+='<option value="'+e.id+'"'+C+">"+e.name.replace(/\+/g," ")+"</option>"}),t("#"+s+" .redux-typography-style").select2("destroy"),t("#"+s+" .redux-typography-style").html(j),t("#"+s+" .redux-typography-style").select2(r),C="",j='<option value=""></option>',t.each(w.subsets,function(e,a){a.id===$||1===redux.field_objects.typography.size(w.subsets)?(C=' selected="selected"',$=a.id,t("#"+s+" input.typography-subsets").val($)):C="",j+='<option value="'+a.id+'"'+C+">"+a.name.replace(/\+/g," ")+"</option>"}),t("#"+s+" .redux-typography-subsets").select2("destroy"),t("#"+s+" .redux-typography-subsets").html(j),t("#"+s+" .redux-typography-subsets").select2(r),t("#"+s+" .redux-typography-subsets").parent().fadeIn("fast"),t("#"+s+" .typography-family-backup").fadeIn("fast")}else w&&(t.each(w,function(e,a){e===x||"normal"===e?(C=' selected="selected"',t("#"+s+" .typography-style .select2-chosen").text(a)):C="",j+='<option value="'+e+'"'+C+">"+a.replace("+"," ")+"</option>"}),t("#"+s+" .redux-typography-style").select2("destroy"),t("#"+s+" .redux-typography-style").html(j),t("#"+s+" .redux-typography-style").select2(r),t("#"+s+" .redux-typography-subsets").parent().fadeOut("fast"),t("#"+s+" .typography-family-backup").fadeOut("fast"));t("#"+s+" .redux-typography-font-family").val(y)}else t(o).hasClass("redux-typography-family-backup")&&""!==l&&t("#"+s+" .redux-typography-font-family-backup").val(l);if(0===t("#"+s+" select.redux-typography-style option[value='"+x+"']").length?(x="",t("#"+s+" select.redux-typography-style").select2("val","")):"400"===x&&t("#"+s+" select.redux-typography-style").select2("val",x),0===t("#"+s+" select.redux-typography-subsets option[value='"+$+"']").length&&($="",t("#"+s+" select.redux-typography-subsets").select2("val",""),t("#"+s+" input.typography-subsets").val($)),t(".style_link_"+s).remove(),null!==y&&"inherit"!==y&&t("#"+s).hasClass("typography-initialized")){var z=y.replace(/\s+/g,"+");if(!0===i){var k=z;x&&""!==x&&(k+=":"+x.replace(/\-/g," ")),$&&""!==$&&(k+="&subset="+$),!1===a&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[k]}}),t("#"+s+" .redux-typography-google").val(!0)}else t("#"+s+" .redux-typography-google").val(!1)}-1!==x.indexOf("italic")?(t("#"+s+" .typography-preview").css("font-style","italic"),t("#"+s+" .typography-font-style").val("italic"),x=x.replace("italic","")):(t("#"+s+" .typography-preview").css("font-style","normal"),t("#"+s+" .typography-font-style").val("")),t("#"+s+" .typography-font-weight").val(x),""===n||void 0===n?t("#"+s+" .typography-font-size").val(""):t("#"+s+" .typography-font-size").val(n+m),""===d||void 0===d?t("#"+s+" .typography-line-height").val(""):t("#"+s+" .typography-line-height").val(d+m),""===h||void 0===h?t("#"+s+" .typography-word-spacing").val(""):t("#"+s+" .typography-word-spacing").val(h+m),""===g||void 0===g?t("#"+s+" .typography-letter-spacing").val(""):t("#"+s+" .typography-letter-spacing").val(g+m),t("#"+s).hasClass("typography-initialized")&&("0"==t("#"+s+" .typography-preview").data("preview-size")&&t("#"+s+" .typography-preview").css("font-size",n+m),t("#"+s+" .typography-preview").css("font-weight",x),t("#"+s+" .typography-preview").css("font-family",y+", sans-serif"),"none"===y&&""===y&&t("#"+s+" .typography-preview").css("font-family","inherit"),t("#"+s+" .typography-preview").css("line-height",d+m),t("#"+s+" .typography-preview").css("word-spacing",h+m),t("#"+s+" .typography-preview").css("letter-spacing",g+m),b&&(t("#"+s+" .typography-preview").css("color",b),t("#"+s+" .typography-preview").css("background-color",redux.field_objects.typography.contrastColour(b))),t("#"+s+" .typography-style .select2-chosen").text(t("#"+s+" .redux-typography-style option:selected").text()),t("#"+s+" .typography-script .select2-chosen").text(t("#"+s+" .redux-typography-subsets option:selected").text()),c&&t("#"+s+" .typography-preview").css("text-align",c),u&&t("#"+s+" .typography-preview").css("text-transform",u),f&&t("#"+s+" .typography-preview").css("font-variant",f),v&&t("#"+s+" .typography-preview").css("text-decoration",v),t("#"+s+" .typography-preview").slideDown()),t("#"+s).hasClass("typography-initialized")||t("#"+s).addClass("typography-initialized"),a=!1,p||redux_change(o)}}(jQuery);